(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{450:function(s,a,t){s.exports=t.p+"assets/img/image-20230516113940673.31b5511c.png"},451:function(s,a,t){s.exports=t.p+"assets/img/image-20230516145942802.e75221c7.png"},452:function(s,a,t){s.exports=t.p+"assets/img/image-20230516150728411.0f7f1965.png"},453:function(s,a,t){s.exports=t.p+"assets/img/Easy_vb.4318a0d1.png"},454:function(s,a,t){s.exports=t.p+"assets/img/signin-01.abb5cbb0.png"},455:function(s,a,t){s.exports=t.p+"assets/img/signin-02.8e4ea37a.png"},456:function(s,a,t){s.exports=t.p+"assets/img/signin-03.5d9dbf61.png"},457:function(s,a,t){s.exports=t.p+"assets/img/signin-04.1f901756.png"},606:function(s,a,t){"use strict";t.r(a);var n=t(3),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"title"}),a("p",[s._v("CTF Reverse（逆向）WriteUp")])]),a("p",[s._v("题目来源： "),a("a",{attrs:{href:"https://ctf.bugku.com/challenges/index/gid/1/tid/7.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("题目 - Bugku CTF"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"入门逆向"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#入门逆向"}},[s._v("#")]),s._v(" 入门逆向")]),s._v(" "),a("details",{staticClass:"custom-block details"},[a("summary",[s._v("入门逆向 详情查看")]),s._v(" "),a("p",[s._v("工具：IDA")]),s._v(" "),a("p",[s._v("下载链接："),a("a",{attrs:{href:"https://www.hex-rays.com/download-center/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Download center (hex-rays.com)"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("解题：")]),s._v(" "),a("p",[s._v("下载文件 baby.exe")]),s._v(" "),a("p",[s._v("使用 IDA 工具默认方式打开，main 文件即可直接查看答案")]),s._v(" "),a("p",[a("img",{attrs:{src:t(450),alt:"image-20230516113940673"}})])]),s._v(" "),a("h2",{attrs:{id:"easy-re"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#easy-re"}},[s._v("#")]),s._v(" Easy_Re")]),s._v(" "),a("details",{staticClass:"custom-block details"},[a("summary",[s._v("Easy_Re 详情查看")]),s._v(" "),a("p",[s._v("工具：IDA")]),s._v(" "),a("p",[s._v("下载链接："),a("a",{attrs:{href:"https://www.hex-rays.com/download-center/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Download center (hex-rays.com)"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("解题：")]),s._v(" "),a("p",[s._v("下载文件 re1.exe")]),s._v(" "),a("p",[s._v("使用 IDA 工具默认方式打开，查看 Hex View-1，ALT+T 搜索"),a("code",[s._v("CTF")]),s._v("即可看到答案")]),s._v(" "),a("p",[a("img",{attrs:{src:t(451),alt:"image-20230516145942802"}})])]),s._v(" "),a("h2",{attrs:{id:"逆向入门"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#逆向入门"}},[s._v("#")]),s._v(" 逆向入门")]),s._v(" "),a("details",{staticClass:"custom-block details"},[a("summary",[s._v("逆向入门 详情查看")]),s._v(" "),a("p",[s._v("解题：")]),s._v(" "),a("p",[s._v("下载文件 admin.exe")]),s._v(" "),a("p",[s._v("修改后缀为 text，文本编辑器打开可以看到 "),a("code",[s._v("data:image/png:base64")]),s._v("，选在在线base64转图片，即可看到转出的二维码，扫描二维码即可看到答案")]),s._v(" "),a("p",[s._v("网址："),a("a",{attrs:{href:"http://www.jsons.cn/img2base64/",target:"_blank",rel:"noopener noreferrer"}},[s._v("图片在线转换base64编码-在线base64编码转换成图片工具 (jsons.cn)"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("img",{attrs:{src:t(452),alt:"image-20230516150728411"}})])]),s._v(" "),a("h2",{attrs:{id:"easy-vb"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#easy-vb"}},[s._v("#")]),s._v(" Easy_vb")]),s._v(" "),a("details",{staticClass:"custom-block details"},[a("summary",[s._v("Easy_vb 详情查看")]),s._v(" "),a("p",[s._v("工具：IDA 下载链接："),a("a",{attrs:{href:"https://www.hex-rays.com/download-center/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Download center (hex-rays.com)"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("解题：")]),s._v(" "),a("p",[s._v("下载得到文件 "),a("code",[s._v("easy_vb.exe")])]),s._v(" "),a("p",[s._v("可以先切换"),a("code",[s._v("Hex View-1")]),s._v("模式查看有没有特殊的字符，"),a("code",[s._v("ALT+T")]),s._v("尝试搜索关键字"),a("code",[s._v("flag")]),s._v("，"),a("code",[s._v("ctf")]),s._v("等，直接搜索到了答案")]),s._v(" "),a("p",[a("img",{attrs:{src:t(453),alt:"image-20230524173455595"}})]),s._v(" "),a("p",[s._v("提交答案报错，根据提示，答案为 flag{xxxx}，修改 MCTF 为 flag ，尝试提交，正确")])]),s._v(" "),a("h2",{attrs:{id:"signin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#signin"}},[s._v("#")]),s._v(" signin")]),s._v(" "),a("details",{staticClass:"custom-block details"},[a("summary",[s._v("signin 详情查看")]),s._v(" "),a("p",[s._v("提　　示: 君远至此，辛苦至甚。 窃谓欲状，亦合依例，并赐此题。")]),s._v(" "),a("p",[s._v("描　　述: 来源：第七届山东省大学生网络安全技能大赛")]),s._v(" "),a("p",[s._v("下载文件得："),a("code",[s._v("sign_in.zip")]),s._v("，解压缩得"),a("code",[s._v("sign_in_apk")]),s._v("，")]),s._v(" "),a("p",[s._v("工具："),a("a",{attrs:{href:"https://github.com/charles2gan/GDA-android-reversing-Tool/releases",target:"_blank",rel:"noopener noreferrer"}},[s._v("Releases · charles2gan/GDA-android-reversing-Tool (github.com)"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("解题：看到解压后是APK文件，及为安卓逆向，寻找对应工具，如上GDA，")]),s._v(" "),a("p",[s._v("查看源码，如下，找到一个 getFlag 函数，大致找到 getFlag() 函数返回值，再逆向就可以了")]),s._v(" "),a("p",[a("img",{attrs:{src:t(454),alt:"image-20230525112952638"}})]),s._v(" "),a("p",[s._v('后续不知道怎么查看，看评论区，"大致说可以再R中搜索对应的编号，安卓为创建的固定值添加的一个标识ID方便重复引用。所以要去找这个写好的固定值究竟在哪里，R里写了tosring在strings里，所以去该xml文件里查"')]),s._v(" "),a("p",[a("img",{attrs:{src:t(455),alt:"image-20230525113717445"}})]),s._v(" "),a("p",[s._v("这里是找到了对应的 16进制编号位置，但是不明白为啥要去 strings.xml 文件中查找，而且这文件有很多，只是正好我找第一个找到了而已")]),s._v(" "),a("p",[a("img",{attrs:{src:t(456),alt:"image-20230525113935149"}})]),s._v(" "),a("p",[s._v("到这里就找到了这一串看起来特殊的值了，根据前面 getFlag下面的 reverse 提示，将这串字符逆序输出，再Base64解码即可得到答案")]),s._v(" "),a("p",[a("img",{attrs:{src:t(457),alt:"image-20230525114158168"}})])]),s._v(" "),a("h2",{attrs:{id:"特殊的base64"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#特殊的base64"}},[s._v("#")]),s._v(" 特殊的Base64")]),s._v(" "),a("details",{staticClass:"custom-block details"},[a("summary",[s._v("特殊的Base64 详情查看")]),s._v(" "),a("p",[s._v("下载文件：解压得"),a("code",[s._v("特殊的Base64.exe")]),s._v("文件")]),s._v(" "),a("p",[s._v("解题：")]),s._v(" "),a("p",[s._v("先IDA打开，"),a("code",[s._v("alt+t")]),s._v("搜索 flag 相关信息，可以看到如下信息")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v(".rdata:0000000000489008 aMtyqm7wjodkrnl db "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mTyqm7wjODkrNLcWl0eqO8K8gc1BPk1GNLgUpI=='")]),s._v(",0\n.rdata:0000000000489008                                         "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" DATA XREF: main+36↑o\n.rdata:0000000000489031 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" const char Str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n.rdata:0000000000489031 Str             db "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Please input your flag!!!!'")]),s._v(",0\n.rdata:0000000000489031                                         "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" DATA XREF: main+51↑o\n.rdata:000000000048904C "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" const char aTheFlagIsRight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n.rdata:000000000048904C aTheFlagIsRight db "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'The flag is right!!!!!!!!!'")]),s._v(",0\n.rdata:000000000048904C                                         "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" DATA XREF: main+C6↑o\n.rdata:0000000000489067 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" const char aThisIsAWrongFl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n.rdata:0000000000489067 aThisIsAWrongFl db "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'This is a wrong flag!!!!!!!!'")]),s._v(",0\n.rdata:0000000000489067                                         "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" DATA XREF: main:loc_40161A↑o\n.rdata:0000000000489084 unk_489084      db    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" DATA XREF: base64Encode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("std::string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("+29↑o\n.rdata:0000000000489085 asc_489085      db "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'=='")]),s._v(",0               "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" DATA XREF: base64Encode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("std::string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("+2AA↑o\n.rdata:0000000000489088 asc_489088      db "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'='")]),s._v(",0                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" DATA XREF: base64Encode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("std::string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("+3DE↑o\n.rdata:000000000048908A                 align 10h\n.rdata:0000000000489090 aAabbccddeeffgg db "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz0987654321/+'")]),s._v(",0\n.rdata:0000000000489090                                         "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" DATA XREF: __static_initialization_and_destruction_0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("int,int"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("+4E↑o\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("p",[s._v("可以看到一串可以的 Base64编码串，"),a("code",[s._v("mTyqm7wjODkrNLcWl0eqO8K8gc1BPk1GNLgUpI==")]),s._v("，直接使用在线工具进行Base64解码，返回信息明显是错误的，")]),s._v(" "),a("p",[s._v("下面看到另外一串可以的字符"),a("code",[s._v("AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz0987654321/+")]),s._v("，看起来像是字典，密码表之类的，百度了 及 查看评论区，了解到 Base64 有个基本的密码表："),a("code",[s._v("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")]),s._v("，看起来和反编译查看到的，长度一致，只是顺序不同，也就说是说，这道题采用了自己的 Base64编码表，而不是常规的，")]),s._v(" "),a("p",[s._v("按顺序，也就是 A对应A，a对应B，B对应C的编码表，前者是题目本身，后者是标准Base64编码表顺序，")]),s._v(" "),a("p",[s._v("百度到python有对应的包可以直接使用")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" base64\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" string\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 用户使用自定义Base64编码表加密的字符串")]),s._v("\nbase64String "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mTyqm7wjODkrNLcWl0eqO8K8gc1BPk1GNLgUpI=="')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 用户自定义Base64编码顺序")]),s._v("\nuserStr "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz0987654321/+"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 标准Base64编码顺序")]),s._v("\nbaseStr "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#利用密码表还原成正常base64编码后的字符串")]),s._v("\nnewBase64Code"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("str1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("translate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("base64String"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("maketrans"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("userStr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("baseStr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#base64解码")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("base64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("b64decode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("newBase64Code"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("decode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[s._v("执行可得结果")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[s._v("92826")]),s._v("@DESKTOP-HI2TV6C MINGW64 ~/Desktop\n$ py 特殊Base64.py\nflag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("Special_Base64_By_Lich"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[88],{639:function(s,a,t){"use strict";t.r(a);var n=t(3),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"title"})]),s._v(" "),a("h1",{attrs:{id:"qa线上问题处理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#qa线上问题处理"}},[s._v("#")]),s._v(" QA线上问题处理")]),s._v(" "),a("p",[s._v("Q：线上发现某个子进程CPU占用持续过高，正常情况下是但时间的暂用过高，对该现象进行排查")]),s._v(" "),a("p",[s._v("A：使用jstack工具定位错误位置")]),s._v(" "),a("p",[s._v("原因：正则代码匹配问题，导致无线循环遍历匹配，子线程CPU占用过高")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("top")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# top命令，查看占用CPU过高的进程，居于首位的")]),s._v("\n\nPID "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v("      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND                                                                           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8713")]),s._v(" prouser   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" 9812m "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".3g  14m S "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("200.8")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7.2")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("93")]),s._v(":58.94 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("java")]),s._v(" \n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("top")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-H")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" 进程ID "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看改进程中，占用CPU高的线程")]),s._v("\nPID "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v("      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND                                                                           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8894")]),s._v(" prouser   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" 9812m "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".3g  14m R "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("99.8")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7.2")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(":28.33 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("java")]),s._v("                                     \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8928")]),s._v(" prouser   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" 9812m "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".3g  14m R "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("99.8")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7.2")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("42")]),s._v(":50.46 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("java")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看长时间占用CPU的线程，打印十进制线程ID，jstack 需要")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("printf")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%x'),a("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8894")]),s._v("\n22be\n\njstack "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8713")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"22be"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("jastack.log "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用jstack工具，查看进程的近1000行日志输出到jastack.log日志文件，查看日志，定位错误位置")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{536:function(_,v,t){_.exports=t.p+"assets/img/image-20220121134016003.50bc614e.png"},537:function(_,v,t){_.exports=t.p+"assets/img/image-20220121134613839.04c52707.png"},538:function(_,v,t){_.exports=t.p+"assets/img/image-20220121140434954.c650aa99.png"},661:function(_,v,t){"use strict";t.r(v);var s=t(3),a=Object(s.a)({},(function(){var _=this,v=_._self._c;return v("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[v("div",{staticClass:"custom-block tip"},[v("p",{staticClass:"title"}),v("p",[_._v("业务上线部署，应用程序升级面临最大挑战是新旧业务切换，将软件从测试的最后阶段带到生产环境，同时要保证系统不间断提供服务。长期以来，业务升级渐渐形成了几个发布策略："),v("code",[_._v("蓝绿发布、灰度发布和滚动发布")]),_._v("，目的是尽可能避免因发布导致的流量丢失或服务不可用问题。"),v("a",{attrs:{href:"https://www.cnblogs.com/nulige/articles/10929182.html",target:"_blank",rel:"noopener noreferrer"}},[_._v("参考一"),v("OutboundLink")],1),_._v("、"),v("a",{attrs:{href:"https://www.jianshu.com/p/5ad1fe9ce448",target:"_blank",rel:"noopener noreferrer"}},[_._v("参考二"),v("OutboundLink")],1)])]),_._v(" "),v("h3",{attrs:{id:"蓝绿发布"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#蓝绿发布"}},[_._v("#")]),_._v(" 蓝绿发布")]),_._v(" "),v("p",[_._v("Blue/Green Deployment")]),_._v(" "),v("p",[_._v("项目逻辑上分为AB组，在项目系统时，首先把A组从负载均衡中摘除，进行新版本的部署。B组仍然继续提供服务。")]),_._v(" "),v("p",[_._v("当A组升级完毕，负载均衡重新接入A组，再把B组从负载列表中摘除，进行新版本的部署。A组重新提供服务。")]),_._v(" "),v("p",[_._v("最后，B组也升级完成，负载均衡重新接入B组，此时，AB组版本都已经升级完成，并且都对外提供服务。")]),_._v(" "),v("p",[v("img",{attrs:{src:t(536),alt:"image-20220121134016003"}})]),_._v(" "),v("p",[v("strong",[_._v("特点：")])]),_._v(" "),v("ul",[v("li",[_._v("如果出问题，影响范围较大；")]),_._v(" "),v("li",[_._v("发布策略简单；")]),_._v(" "),v("li",[_._v("用户无感知，平滑过渡；")]),_._v(" "),v("li",[_._v("升级/回滚速度快。")])]),_._v(" "),v("p",[v("strong",[_._v("缺点：")])]),_._v(" "),v("ul",[v("li",[_._v("需要准备正常业务使用资源的两倍以上服务器，防止升级期间单组无法承载业务突发；")]),_._v(" "),v("li",[_._v("短时间内浪费一定资源成本；")]),_._v(" "),v("li",[_._v("基础设施无改动，增大升级稳定性。")])]),_._v(" "),v("h3",{attrs:{id:"灰度发布-金丝雀发布"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#灰度发布-金丝雀发布"}},[_._v("#")]),_._v(" 灰度发布 | 金丝雀发布")]),_._v(" "),v("p",[_._v("Canary Deployment")]),_._v(" "),v("p",[_._v("灰度发布只升级部分服务，即让一部分用户继续用老版本，一部分用户开始用新版本，如果用户对新版本没什么意见，那么逐步扩大范围，把所有用户都迁移到新版本上面来。")]),_._v(" "),v("p",[v("img",{attrs:{src:t(537),alt:"image-20220121134613839"}})]),_._v(" "),v("p",[v("strong",[_._v("特点：")])]),_._v(" "),v("ul",[v("li",[_._v("保证整体系统稳定性，在初始灰度的时候就可以发现、调整问题，影响范围可控；")]),_._v(" "),v("li",[_._v("新功能逐步评估性能，稳定性和健康状况，如果出问题影响范围很小，相对用户体验也少；")]),_._v(" "),v("li",[_._v("用户无感知，平滑过渡。")])]),_._v(" "),v("p",[v("strong",[_._v("缺点：")])]),_._v(" "),v("ul",[v("li",[_._v("自动化要求高")])]),_._v(" "),v("p",[v("strong",[_._v("部署过程：")])]),_._v(" "),v("ul",[v("li",[_._v("从LB摘掉灰度服务器，升级成功后再加入LB；")]),_._v(" "),v("li",[_._v("少量用户流量到新版本；")]),_._v(" "),v("li",[_._v("如果灰度服务器测试成功，升级剩余服务器。")])]),_._v(" "),v("p",[_._v("金丝雀发布")]),_._v(" "),v("h3",{attrs:{id:"滚动发布"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#滚动发布"}},[_._v("#")]),_._v(" 滚动发布")]),_._v(" "),v("p",[_._v("Rolling Update Deployment")]),_._v(" "),v("p",[_._v("金丝雀|灰度发布的优化")]),_._v(" "),v("ul",[v("li",[_._v("红色：正在更新的实例")]),_._v(" "),v("li",[_._v("蓝色：更新完成并加入集群的实例")]),_._v(" "),v("li",[_._v("绿色：正在运行的实例")])]),_._v(" "),v("p",[v("img",{attrs:{src:t(538),alt:"image-20220121140434954"}})]),_._v(" "),v("p",[v("strong",[_._v("特点：")])]),_._v(" "),v("ul",[v("li",[_._v("用户无感知，平滑过渡；")]),_._v(" "),v("li",[_._v("节约资源。")])]),_._v(" "),v("p",[v("strong",[_._v("特点：")])]),_._v(" "),v("ul",[v("li",[_._v("部署时间慢，取决于每阶段更新时间；")]),_._v(" "),v("li",[_._v("发布策略较复杂；")]),_._v(" "),v("li",[_._v("无法确定OK的环境，不易回滚。")])]),_._v(" "),v("h3",{attrs:{id:""}},[v("a",{staticClass:"header-anchor",attrs:{href:"#"}},[_._v("#")])])])}),[],!1,null,null,null);v.default=a.exports}}]);
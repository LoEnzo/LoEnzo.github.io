(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{508:function(s,a,t){s.exports=t.p+"assets/img/image-20200407121501907.f2c6952c.png"},509:function(s,a,t){s.exports=t.p+"assets/img/image-20200408194716912.934ff829.png"},625:function(s,a,t){s.exports=t.p+"assets/img/image-20200406225334627.102ffc00.png"},626:function(s,a,t){s.exports=t.p+"assets/img/image-20200407100850484.5c0ca682.png"},627:function(s,a,t){s.exports=t.p+"assets/img/image-20200408193950807.cbf7a130.png"},796:function(s,a,t){"use strict";t.r(a);var n=t(10),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"title"}),n("p",[s._v("本章主要学习K8s资源管理，简单的实战部署练习。根据"),n("a",{attrs:{href:"https://www.bilibili.com/video/BV1cK4y1L7Am?p=1",target:"_blank",rel:"noopener noreferrer"}},[s._v("哔哩哔哩黑马视频"),n("OutboundLink")],1),s._v("学习，学习来源于搬迁，部分文档有根据自己学习进行修改和补充，"),n("a",{attrs:{href:"https://www.orchome.com/1786",target:"_blank",rel:"noopener noreferrer"}},[s._v("文档学习资源"),n("OutboundLink")],1)])]),s._v(" "),n("h1",{attrs:{id:"第三章-资源管理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第三章-资源管理"}},[s._v("#")]),s._v(" 第三章 资源管理")]),s._v(" "),n("p",[s._v("本章节主要介绍yaml语法和kubernetes的资源管理方式")]),s._v(" "),n("h2",{attrs:{id:"资源管理介绍"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#资源管理介绍"}},[s._v("#")]),s._v(" 资源管理介绍")]),s._v(" "),n("p",[s._v("在kubernetes中，所有的内容都抽象为资源，用户需要通过操作资源来管理kubernetes。")]),s._v(" "),n("blockquote",[n("p",[s._v("​    kubernetes的本质上就是一个集群系统，用户可以在集群中部署各种服务，所谓的部署服务，其实就是在kubernetes集群中运行一个个的容器，并将指定的程序跑在容器中。")]),s._v(" "),n("p",[s._v("​    kubernetes的最小管理单元是pod而不是容器，所以只能将容器放在"),n("code",[s._v("Pod")]),s._v("中，而kubernetes一般也不会直接管理Pod，而是通过"),n("code",[s._v("Pod控制器")]),s._v("来管理Pod的。")]),s._v(" "),n("p",[s._v("​    Pod可以提供服务之后，就要考虑如何访问Pod中服务，kubernetes提供了"),n("code",[s._v("Service")]),s._v("资源实现这个功能。")]),s._v(" "),n("p",[s._v("​    当然，如果Pod中程序的数据需要持久化，kubernetes还提供了各种"),n("code",[s._v("存储")]),s._v("系统。")])]),s._v(" "),n("img",{staticStyle:{zoom:"200%"},attrs:{src:t(625),alt:"image-20200406225334627"}}),s._v(" "),n("blockquote",[n("p",[s._v("学习kubernetes的核心，就是学习如何对集群上的"),n("code",[s._v("Pod、Pod控制器、Service、存储")]),s._v("等各种资源进行操作")])]),s._v(" "),n("h2",{attrs:{id:"yaml语言介绍"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#yaml语言介绍"}},[s._v("#")]),s._v(" YAML语言介绍")]),s._v(" "),n("p",[s._v("​    YAML是一个类似 XML、JSON 的标记性语言。它强调以"),n("strong",[s._v("数据")]),s._v('为中心，并不是以标识语言为重点。因而YAML本身的定义比较简单，号称"一种人性化的数据格式语言"。')]),s._v(" "),n("div",{staticClass:"language-xml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-xml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("heima")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("age")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("15"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("age")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("address")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("Beijing"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("address")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("heima")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("heima")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("age")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("address")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Beijing\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("YAML的语法比较简单，主要有下面几个：")]),s._v(" "),n("ul",[n("li",[s._v("大小写敏感")]),s._v(" "),n("li",[s._v("使用缩进表示层级关系")]),s._v(" "),n("li",[s._v("缩进不允许使用tab，只允许空格( 低版本限制 )")]),s._v(" "),n("li",[s._v("缩进的空格数不重要，只要相同层级的元素左对齐即可")]),s._v(" "),n("li",[s._v("'#'表示注释")])]),s._v(" "),n("p",[s._v("YAML支持以下几种数据类型：")]),s._v(" "),n("ul",[n("li",[s._v("纯量：单个的、不可再分的值")]),s._v(" "),n("li",[s._v("对象：键值对的集合，又称为映射（mapping）/ 哈希（hash） / 字典（dictionary）")]),s._v(" "),n("li",[s._v("数组：一组按次序排列的值，又称为序列（sequence） / 列表（list）")])]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 纯量, 就是指的一个简单的值，字符串、布尔值、整数、浮点数、Null、时间、日期")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1 布尔类型")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("c1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" true (或者True)\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2 整型")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("c2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("234")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3 浮点型")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("c3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.14")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4 null类型 ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("c4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token null important"}},[s._v("~")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用~表示null")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 5 日期类型")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("c5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token datetime number"}},[s._v("2018-02-17")]),s._v("    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 日期必须使用ISO 8601格式，即yyyy-MM-dd")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 6 时间类型")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("c6")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token datetime number"}},[s._v("2018-02-17T15:02:31+08:00")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 时间使用ISO 8601格式，时间和日期之间使用T连接，最后使用+代表时区")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 7 字符串类型")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("c7")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" heima     "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 简单写法，直接写值 , 如果字符串中间有特殊字符，必须使用双引号或者单引号包裹 ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("c8")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" line1\n    line2     "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 字符串过多的情况可以拆成多行，每一行会被转化成一个空格")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])]),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 对象")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 形式一(推荐):")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("heima")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("age")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("address")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Beijing\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 形式二(了解):")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("heima")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("age")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("address")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Beijing"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 数组")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 形式一(推荐):")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("address")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 顺义\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 昌平\t\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 形式二(了解):")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("address")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("顺义"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("昌平"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("blockquote",[n("p",[s._v("小提示：")]),s._v(" "),n("p",[s._v("​\t1  书写yaml切记"),n("code",[s._v(":")]),s._v(" 后面要加一个空格")]),s._v(" "),n("p",[s._v("​\t2  如果需要将多段yaml配置放在一个文件中，中间要使用"),n("code",[s._v("---")]),s._v("分隔")]),s._v(" "),n("p",[s._v("​    3 下面是一个yaml转json的网站，可以通过它验证yaml是否书写正确")]),s._v(" "),n("p",[s._v("​       https://www.json2yaml.com/convert-yaml-to-json")])]),s._v(" "),n("h2",{attrs:{id:"资源管理方式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#资源管理方式"}},[s._v("#")]),s._v(" 资源管理方式")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("命令式对象管理：直接使用命令去操作kubernetes资源")]),s._v(" "),n("p",[n("code",[s._v("kubectl run nginx-pod --image=nginx:1.17.1 --port=80")])])]),s._v(" "),n("li",[n("p",[s._v("命令式对象配置：通过命令配置和配置文件去操作kubernetes资源")]),s._v(" "),n("p",[n("code",[s._v("kubectl create/patch -f nginx-pod.yaml")])])]),s._v(" "),n("li",[n("p",[s._v("声明式对象配置：通过apply命令和配置文件去操作kubernetes资源")]),s._v(" "),n("p",[n("code",[s._v("kubectl apply -f nginx-pod.yaml")])])])]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",[s._v("类型")]),s._v(" "),n("th",[s._v("操作对象")]),s._v(" "),n("th",[s._v("适用环境")]),s._v(" "),n("th",[s._v("优点")]),s._v(" "),n("th",[s._v("缺点")])])]),s._v(" "),n("tbody",[n("tr",[n("td",[s._v("命令式对象管理")]),s._v(" "),n("td",[s._v("对象")]),s._v(" "),n("td",[s._v("测试")]),s._v(" "),n("td",[s._v("简单")]),s._v(" "),n("td",[s._v("只能操作活动对象，无法审计、跟踪")])]),s._v(" "),n("tr",[n("td",[s._v("命令式对象配置")]),s._v(" "),n("td",[s._v("文件")]),s._v(" "),n("td",[s._v("开发")]),s._v(" "),n("td",[s._v("可以审计、跟踪")]),s._v(" "),n("td",[s._v("项目大时，配置文件多，操作麻烦")])]),s._v(" "),n("tr",[n("td",[s._v("声明式对象配置")]),s._v(" "),n("td",[s._v("目录")]),s._v(" "),n("td",[s._v("开发")]),s._v(" "),n("td",[s._v("支持目录操作")]),s._v(" "),n("td",[s._v("意外情况下难以调试")])])])]),s._v(" "),n("h3",{attrs:{id:"命令式对象管理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#命令式对象管理"}},[s._v("#")]),s._v(" 命令式对象管理")]),s._v(" "),n("p",[n("strong",[s._v("kubectl命令")])]),s._v(" "),n("p",[s._v("​    kubectl是kubernetes集群的命令行工具，通过它能够对集群本身进行管理，并能够在集群上进行容器化应用的安装部署。kubectl命令的语法如下：")]),s._v(" "),n("div",{staticClass:"language-md line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-md"}},[n("code",[s._v("kubectl "),n("span",{pre:!0,attrs:{class:"token url"}},[s._v("["),n("span",{pre:!0,attrs:{class:"token content"}},[s._v("command")]),s._v("] ["),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("type")]),s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token url"}},[s._v("["),n("span",{pre:!0,attrs:{class:"token content"}},[s._v("name")]),s._v("] ["),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("flags")]),s._v("]")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[n("strong",[s._v("comand")]),s._v("：指定要对资源执行的操作，例如create、get、delete")]),s._v(" "),n("p",[n("strong",[s._v("type")]),s._v("：指定资源类型，比如deployment、pod、service")]),s._v(" "),n("p",[n("strong",[s._v("name")]),s._v("：指定资源的名称，名称大小写敏感")]),s._v(" "),n("p",[n("strong",[s._v("flags")]),s._v("：指定额外的可选参数")]),s._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看所有pod")]),s._v("\nkubectl get pod \n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看某个pod")]),s._v("\nkubectl get pod pod_name\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看某个pod,以yaml格式展示结果")]),s._v("\nkubectl get pod pod_name "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("o yaml\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[n("strong",[s._v("资源类型")])]),s._v(" "),n("p",[s._v("kubernetes中所有的内容都抽象为资源，可以通过下面的命令进行查看:")]),s._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[s._v("kubectl api-resources\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("经常使用的资源有下面这些：")]),s._v(" "),n("table",[n("tr",[n("th",[s._v("资源分类")]),s._v(" "),n("th",[s._v("资源名称")]),s._v(" "),n("th",[s._v("缩写")]),s._v(" "),n("th",[s._v("资源作用")])]),s._v(" "),n("tr",[n("td",{attrs:{rowspan:"2"}},[s._v("集群级别资源")]),s._v(" "),n("td",[s._v("nodes")]),s._v(" "),n("td",[s._v("no")]),s._v(" "),n("td",[s._v("集群组成部分")])]),s._v(" "),n("tr",[n("td",[s._v("namespaces")]),s._v(" "),n("td",[s._v("ns")]),s._v(" "),n("td",[s._v("隔离Pod")])]),s._v(" "),n("tr",[n("td",[s._v("pod资源")]),s._v(" "),n("td",[s._v("pods")]),s._v(" "),n("td",[s._v("po")]),s._v(" "),n("td",[s._v("装载容器")])]),s._v(" "),n("tr",[n("td",{attrs:{rowspan:"8"}},[s._v("pod资源控制器")]),s._v(" "),n("td",[s._v("replicationcontrollers")]),s._v(" "),n("td",[s._v("rc")]),s._v(" "),n("td",[s._v("控制pod资源")])]),s._v(" "),n("tr",[n("td",[s._v("replicasets")]),s._v(" "),n("td",[s._v("rs")]),s._v(" "),n("td",[s._v("控制pod资源")])]),s._v(" "),n("tr",[n("td",[s._v("deployments")]),s._v(" "),n("td",[s._v("deploy")]),s._v(" "),n("td",[s._v("控制pod资源")])]),s._v(" "),n("tr",[n("td",[s._v("daemonsets")]),s._v(" "),n("td",[s._v("ds")]),s._v(" "),n("td",[s._v("控制pod资源")])]),s._v(" "),n("tr",[n("td",[s._v("jobs")]),s._v(" "),n("td"),s._v(" "),n("td",[s._v("控制pod资源")])]),s._v(" "),n("tr",[n("td",[s._v("cronjobs")]),s._v(" "),n("td",[s._v("cj")]),s._v(" "),n("td",[s._v("控制pod资源")])]),s._v(" "),n("tr",[n("td",[s._v("horizontalpodautoscalers")]),s._v(" "),n("td",[s._v("hpa")]),s._v(" "),n("td",[s._v("控制pod资源")])]),s._v(" "),n("tr",[n("td",[s._v("statefulsets")]),s._v(" "),n("td",[s._v("sts")]),s._v(" "),n("td",[s._v("控制pod资源")])]),s._v(" "),n("tr",[n("td",{attrs:{rowspan:"2"}},[s._v("服务发现资源")]),s._v(" "),n("td",[s._v("services")]),s._v(" "),n("td",[s._v("svc")]),s._v(" "),n("td",[s._v("统一pod对外接口")])]),s._v(" "),n("tr",[n("td",[s._v("ingress")]),s._v(" "),n("td",[s._v("ing")]),s._v(" "),n("td",[s._v("统一pod对外接口")])]),s._v(" "),n("tr",[n("td",{attrs:{rowspan:"3"}},[s._v("存储资源")]),s._v(" "),n("td",[s._v("volumeattachments")]),s._v(" "),n("td"),s._v(" "),n("td",[s._v("存储")])]),s._v(" "),n("tr",[n("td",[s._v("persistentvolumes")]),s._v(" "),n("td",[s._v("pv")]),s._v(" "),n("td",[s._v("存储")])]),s._v(" "),n("tr",[n("td",[s._v("persistentvolumeclaims")]),s._v(" "),n("td",[s._v("pvc")]),s._v(" "),n("td",[s._v("存储")])]),s._v(" "),n("tr",[n("td",{attrs:{rowspan:"2"}},[s._v("配置资源")]),s._v(" "),n("td",[s._v("configmaps")]),s._v(" "),n("td",[s._v("cm")]),s._v(" "),n("td",[s._v("配置")])]),s._v(" "),n("tr",[n("td",[s._v("secrets")]),s._v(" "),n("td"),s._v(" "),n("td",[s._v("配置")])])]),s._v(" "),n("p",[n("strong",[s._v("操作")])]),s._v(" "),n("p",[s._v("kubernetes允许对资源进行多种操作，可以通过--help查看详细的操作命令")]),s._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[s._v("kubectl "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("help\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("经常使用的操作有下面这些：")]),s._v(" "),n("table",[n("tr",[n("th",[s._v("命令分类")]),s._v(" "),n("th",[s._v("命令")]),s._v(" "),n("th",[s._v("翻译")]),s._v(" "),n("th",[s._v("命令作用")])]),s._v(" "),n("tr",[n("td",{attrs:{rowspan:"6"}},[s._v("基本命令")]),s._v(" "),n("td",[s._v("create")]),s._v(" "),n("td",[s._v("创建")]),s._v(" "),n("td",[s._v("创建一个资源")])]),s._v(" "),n("tr",[n("td",[s._v("edit")]),s._v(" "),n("td",[s._v("编辑")]),s._v(" "),n("td",[s._v("编辑一个资源")])]),s._v(" "),n("tr",[n("td",[s._v("get")]),s._v(" "),n("td",[s._v("获取")]),s._v(" "),n("td",[s._v("获取一个资源")])]),s._v(" "),n("tr",[n("td",[s._v("patch")]),s._v(" "),n("td",[s._v("更新")]),s._v(" "),n("td",[s._v("更新一个资源")])]),s._v(" "),n("tr",[n("td",[s._v("delete")]),s._v(" "),n("td",[s._v("删除")]),s._v(" "),n("td",[s._v("删除一个资源")])]),s._v(" "),n("tr",[n("td",[s._v("explain")]),s._v(" "),n("td",[s._v("解释")]),s._v(" "),n("td",[s._v("展示资源文档")])]),s._v(" "),n("tr",[n("td",{attrs:{rowspan:"10"}},[s._v("运行和调试")]),s._v(" "),n("td",[s._v("run")]),s._v(" "),n("td",[s._v("运行")]),s._v(" "),n("td",[s._v("在集群中运行一个指定的镜像")])]),s._v(" "),n("tr",[n("td",[s._v("expose")]),s._v(" "),n("td",[s._v("暴露")]),s._v(" "),n("td",[s._v("暴露资源为Service")])]),s._v(" "),n("tr",[n("td",[s._v("describe")]),s._v(" "),n("td",[s._v("描述")]),s._v(" "),n("td",[s._v("显示资源内部信息")])]),s._v(" "),n("tr",[n("td",[s._v("logs")]),s._v(" "),n("td",[s._v("日志")]),s._v(" "),n("td",[s._v("输出容器在 pod 中的日志")])]),s._v(" "),n("tr",[n("td",[s._v("attach")]),s._v(" "),n("td",[s._v("缠绕")]),s._v(" "),n("td",[s._v("进入运行中的容器")])]),s._v(" "),n("tr",[n("td",[s._v("exec")]),s._v(" "),n("td",[s._v("执行")]),s._v(" "),n("td",[s._v("执行容器中的一个命令")])]),s._v(" "),n("tr",[n("td",[s._v("cp")]),s._v(" "),n("td",[s._v("复制")]),s._v(" "),n("td",[s._v("在Pod内外复制文件")])]),s._v(" "),n("tr",[n("td",[s._v("rollout")]),s._v(" "),n("td",[s._v("首次展示")]),s._v(" "),n("td",[s._v("管理资源的发布")])]),s._v(" "),n("tr",[n("td",[s._v("scale")]),s._v(" "),n("td",[s._v("规模")]),s._v(" "),n("td",[s._v("扩(缩)容Pod的数量")])]),s._v(" "),n("tr",[n("td",[s._v("autoscale")]),s._v(" "),n("td",[s._v("自动调整")]),s._v(" "),n("td",[s._v("自动调整Pod的数量")])]),s._v(" "),n("tr",[n("td",{attrs:{rowspan:"2"}},[s._v("高级命令")]),s._v(" "),n("td",[s._v("apply")]),s._v(" "),n("td",[s._v("rc")]),s._v(" "),n("td",[s._v("通过文件对资源进行配置")])]),s._v(" "),n("tr",[n("td",[s._v("label")]),s._v(" "),n("td",[s._v("标签")]),s._v(" "),n("td",[s._v("更新资源上的标签")])]),s._v(" "),n("tr",[n("td",{attrs:{rowspan:"2"}},[s._v("其他命令")]),s._v(" "),n("td",[s._v("cluster-info")]),s._v(" "),n("td",[s._v("集群信息")]),s._v(" "),n("td",[s._v("显示集群信息")])]),s._v(" "),n("tr",[n("td",[s._v("version")]),s._v(" "),n("td",[s._v("版本")]),s._v(" "),n("td",[s._v("显示当前Server和Client的版本")])])]),s._v(" "),n("p",[s._v("下面以一个namespace / pod的创建和删除简单演示下命令的使用：")]),s._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建一个namespace")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl create namespace dev")]),s._v("\nnamespace/dev created\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取namespace")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get ns")]),s._v("\nNAME              STATUS   AGE\ndefault           Active   21h\ndev               Active   21s\nkube-node-lease   Active   21h\nkube-public       Active   21h\nkube-system       Active   21h\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在此namespace下创建并运行一个nginx的Pod")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl run pod --image=nginx -n dev")]),s._v("\nkubectl run "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("generator=deployment/apps"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("v1 is DEPRECATED and will be removed in a future version"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" Use kubectl run "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("generator=run-pod/v1 or kubectl create instead"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\ndeployment"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apps/pod created\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看新创建的pod")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get pod -n dev")]),s._v("\nNAME                   READY   STATUS    RESTARTS   AGE\npod-864f9875b9-pcw7x   1/1     Running   0          21s\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除指定的pod")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl delete pod pod-864f9875b9-pcw7x")]),s._v("\npod "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pod-864f9875b9-pcw7x"')]),s._v(" deleted\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除指定的namespace")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl delete ns dev")]),s._v("\nnamespace "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dev"')]),s._v(" deleted\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br")])]),n("h3",{attrs:{id:"命令式对象配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#命令式对象配置"}},[s._v("#")]),s._v(" 命令式对象配置")]),s._v(" "),n("p",[s._v("命令式对象配置就是使用命令配合配置文件一起来操作kubernetes资源。")]),s._v(" "),n("p",[s._v("1） 创建一个nginxpod.yaml，内容如下：")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建一个dev的namespace")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Namespace\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" dev\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在dev里面创建一个名叫nginxpod的pod，里面是一个nginx的容器")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Pod\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginxpod\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" dev\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("containers\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("1.17.1\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br")])]),n("p",[s._v("2）执行create命令，创建资源：")]),s._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl create -f nginxpod.yaml")]),s._v("\nnamespace/dev created\npod/nginxpod created\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("此时发现创建了两个资源对象，分别是namespace和pod")]),s._v(" "),n("p",[s._v("3）执行get命令，查看资源：")]),s._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  kubectl get -f nginxpod.yaml")]),s._v("\nNAME            STATUS   AGE\nnamespace/dev   Active   18s\n\nNAME            READY   STATUS    RESTARTS   AGE\npod/nginxpod    1/1     Running   0          17s\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("这样就显示了两个资源对象的信息")]),s._v(" "),n("p",[s._v("4）执行delete命令，删除资源：")]),s._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl delete -f nginxpod.yaml")]),s._v("\nnamespace "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dev"')]),s._v(" deleted\npod "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginxpod"')]),s._v(" deleted\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("此时发现两个资源对象被删除了")]),s._v(" "),n("div",{staticClass:"language-md line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-md"}},[n("code",[s._v("总结:\n\t命令式对象配置的方式操作资源，可以简单的认为：命令  +  yaml配置文件（里面是命令需要的各种参数）\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"声明式对象配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#声明式对象配置"}},[s._v("#")]),s._v(" 声明式对象配置")]),s._v(" "),n("p",[s._v("声明式对象配置跟命令式对象配置很相似，但是它只有一个命令apply。")]),s._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 首先执行一次kubectl apply -f yaml文件，发现创建了资源")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  kubectl apply -f nginxpod.yaml")]),s._v("\nnamespace/dev created\npod/nginxpod created\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 再次执行一次kubectl apply -f yaml文件，发现说资源没有变动")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  kubectl apply -f nginxpod.yaml")]),s._v("\nnamespace/dev unchanged\npod/nginxpod unchanged\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("div",{staticClass:"language-md line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-md"}},[n("code",[s._v("总结:\n    其实声明式对象配置就是使用apply描述一个资源最终的状态（在yaml中定义状态）\n\t使用apply操作资源：\n        如果资源不存在，就创建，相当于 kubectl create\n\t\t如果资源已存在，就更新，相当于 kubectl patch\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("blockquote",[n("p",[s._v("扩展：kubectl可以在node节点上运行吗 ?")])]),s._v(" "),n("p",[s._v("​    kubectl的运行是需要进行配置的，它的配置文件是$HOME/.kube，如果想要在node节点运行此命令，需要将master上的.kube文件复制到node节点上，即在master节点上执行下面操作：")]),s._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[s._v("scp  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("r  HOME/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("kube   node1: HOME/\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("blockquote",[n("p",[s._v("使用推荐:  三种方式应该怎么用 ?")])]),s._v(" "),n("p",[s._v("创建/更新资源      使用声明式对象配置 kubectl apply -f  XXX.yaml")]),s._v(" "),n("p",[s._v("删除资源              使用命令式对象配置 kubectl delete -f  XXX.yaml")]),s._v(" "),n("p",[s._v("查询资源              使用命令式对象管理 kubectl get(describe) 资源名称")]),s._v(" "),n("h1",{attrs:{id:"第四章-实战入门"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第四章-实战入门"}},[s._v("#")]),s._v(" 第四章 实战入门")]),s._v(" "),n("p",[s._v("本章节将介绍如何在kubernetes集群中部署一个nginx服务，并且能够对其进行访问。")]),s._v(" "),n("h2",{attrs:{id:"namespace"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#namespace"}},[s._v("#")]),s._v(" Namespace")]),s._v(" "),n("p",[s._v("​    Namespace是kubernetes系统中的一种非常重要资源，它的主要作用是用来实现"),n("strong",[s._v("多套环境的资源隔离")]),s._v("或者"),n("strong",[s._v("多租户的资源隔离")]),s._v("。")]),s._v(" "),n("p",[s._v('​    默认情况下，kubernetes集群中的所有的Pod都是可以相互访问的。但是在实际中，可能不想让两个Pod之间进行互相的访问，那此时就可以将两个Pod划分到不同的namespace下。kubernetes通过将集群内部的资源分配到不同的Namespace中，可以形成逻辑上的"组"，以方便不同的组的资源进行隔离使用和管理。')]),s._v(" "),n("p",[s._v("​    可以通过kubernetes的授权机制，将不同的namespace交给不同租户进行管理，这样就实现了多租户的资源隔离。此时还能结合kubernetes的资源配额机制，限定不同租户能占用的资源，例如CPU使用量、内存使用量等等，来实现租户可用资源的管理。")]),s._v(" "),n("img",{staticStyle:{zoom:"80%",border:"1px solid"},attrs:{src:t(626),alt:"image-20200407100850484"}}),s._v(" "),n("p",[s._v("kubernetes在集群启动之后，会默认创建几个namespace")]),s._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl  get namespace")]),s._v("\nNAME              STATUS   AGE\ndefault           Active   45h     "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  所有未指定Namespace的对象都会被分配在default命名空间")]),s._v("\nkube-node-lease   Active   45h     "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  集群节点之间的心跳维护，v1.13开始引入")]),s._v("\nkube-public       Active   45h     "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  此命名空间下的资源可以被所有人访问（包括未认证用户）")]),s._v("\nkube-system       Active   45h     "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  所有由Kubernetes系统创建的资源都处于这个命名空间")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("下面来看namespace资源的具体操作：")]),s._v(" "),n("p",[n("strong",[s._v("查看")])]),s._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1 查看所有的ns  命令：kubectl get ns")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get ns")]),s._v("\nNAME              STATUS   AGE\ndefault           Active   45h\nkube-node-lease   Active   45h\nkube-public       Active   45h     \nkube-system       Active   45h     \n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2 查看指定的ns   命令：kubectl get ns ns名称")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get ns default")]),s._v("\nNAME      STATUS   AGE\ndefault   Active   45h\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3 指定输出格式  命令：kubectl get ns ns名称  -o 格式参数")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubernetes支持的格式有很多，比较常见的是wide、json、yaml")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get ns default -o yaml")]),s._v("\napiVersion: v1\nkind: Namespace\nmetadata:\n  creationTimestamp: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2020-04-05T04:44:16Z"')]),s._v("\n  name: default\n  resourceVersion: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"151"')]),s._v("\n  selfLink: "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("api/v1/namespaces/default\n  uid: 7405f73a-e486-43d4-9db6-145f1409f090\nspec:\n  finalizers:\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" kubernetes\nstatus:\n  phase: Active\n  \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4 查看ns详情  命令：kubectl describe ns ns名称")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl describe ns default")]),s._v("\nName:         default\nLabels:       <none>\nAnnotations:  <none>\nStatus:       Active  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Active 命名空间正在使用中  Terminating 正在删除命名空间")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ResourceQuota 针对namespace做的资源限制")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# LimitRange针对namespace中的每个组件做的资源限制")]),s._v("\nNo resource quota"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\nNo LimitRange resource"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br")])]),n("p",[n("strong",[s._v("创建")])]),s._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建namespace")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl create ns dev")]),s._v("\nnamespace/dev created\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[n("strong",[s._v("删除")])]),s._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除namespace")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl delete ns dev")]),s._v("\nnamespace "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dev"')]),s._v(" deleted\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[n("strong",[s._v("配置方式")])]),s._v(" "),n("p",[s._v("首先准备一个yaml文件：ns-dev.yaml")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Namespace\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" dev\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("然后就可以执行对应的创建和删除命令了：")]),s._v(" "),n("p",[s._v("​    创建：kubectl  create  -f  ns-dev.yaml")]),s._v(" "),n("p",[s._v("​    删除：kubectl  delete  -f  ns-dev.yaml")]),s._v(" "),n("h2",{attrs:{id:"pod"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#pod"}},[s._v("#")]),s._v(" Pod")]),s._v(" "),n("p",[s._v("Pod是kubernetes集群进行管理的最小单元，程序要运行必须部署在容器中，而容器必须存在于Pod中。")]),s._v(" "),n("p",[s._v("Pod可以认为是容器的封装，一个Pod中可以存在一个或者多个容器。")]),s._v(" "),n("img",{staticStyle:{zoom:"80%"},attrs:{src:t(508),alt:"image-20200407121501907"}}),s._v(" "),n("p",[s._v("kubernetes在集群启动之后，集群中的各个组件也都是以Pod方式运行的。可以通过下面命令查看：")]),s._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get pod -n kube-system")]),s._v("\nNAMESPACE     NAME                             READY   STATUS    RESTARTS   AGE\nkube-system   coredns-6955765f44-68g6v         1/1     Running   0          2d1h\nkube-system   coredns-6955765f44-cs5r8         1/1     Running   0          2d1h\nkube-system   etcd-master                      1/1     Running   0          2d1h\nkube-system   kube-apiserver-master            1/1     Running   0          2d1h\nkube-system   kube-controller-manager-master   1/1     Running   0          2d1h\nkube-system   kube-flannel-ds-amd64-47r25      1/1     Running   0          2d1h\nkube-system   kube-flannel-ds-amd64-ls5lh      1/1     Running   0          2d1h\nkube-system   kube-proxy-685tk                 1/1     Running   0          2d1h\nkube-system   kube-proxy-87spt                 1/1     Running   0          2d1h\nkube-system   kube-scheduler-master            1/1     Running   0          2d1h\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("p",[n("strong",[s._v("创建并运行")])]),s._v(" "),n("p",[s._v("kubernetes没有提供单独运行Pod的命令，都是通过Pod控制器来实现的")]),s._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令格式： kubectl run (pod控制器名称) [参数] ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --image  指定Pod的镜像")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --port   指定端口")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --namespace  指定namespace")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl run nginx --image=nginx:1.17.1 --port=80 --namespace dev ")]),s._v("\ndeployment"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apps/nginx created\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[n("strong",[s._v("查看pod信息")])]),s._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看Pod基本信息")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get pods -n dev")]),s._v("\nNAME                     READY   STATUS    RESTARTS   AGE\nnginx-5ff7956ff6-fg2db   1/1     Running   0          43s\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看Pod的详细信息")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl describe pod nginx-5ff7956ff6-fg2db -n dev")]),s._v("\nName:         nginx-5ff7956ff6-fg2db\nNamespace:    dev\nPriority:     0\nNode:         node1/192"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("168"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("109"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("101\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("Start")]),s._v(" Time:   Wed"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 08 Apr 2020 09:29:24 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("0800\nLabels:       pod-template-hash=5ff7956ff6\n              run=nginx\nAnnotations:  <none>\nStatus:       Running\nIP:           10"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("244"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("23\nIPs:\n  IP:           10"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("244"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("23\nControlled By:  ReplicaSet/nginx-5ff7956ff6\nContainers:\n  nginx:\n    Container ID:   docker:"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("4c62b8c0648d2512380f4ffa5da2c99d16e05634979973449c98e9b829f6253c\n    Image:          nginx:1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("17"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("1\n    Image ID:       docker-pullable:"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx@sha256:485b610fefec7ff6c463ced9623314a04ed67e3945b9c08d7e53a47f6d108dc7\n    Port:           80/TCP\n    Host Port:      0/TCP\n    State:          Running\n      Started:      Wed"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 08 Apr 2020 09:30:01 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("0800\n    Ready:          True\n    Restart Count:  0\n    Environment:    <none>\n    Mounts:\n      "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("run/secrets/kubernetes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io/serviceaccount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" default-token-hwvvw "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ro"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nConditions:\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("Type")]),s._v("              Status\n  Initialized       True\n  Ready             True\n  ContainersReady   True\n  PodScheduled      True\nVolumes:\n  default-token-hwvvw:\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("Type")]),s._v(":        Secret "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("a volume populated by a Secret"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    SecretName:  default-token-hwvvw\n    Optional:    false\nQoS "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Class")]),s._v(":       BestEffort\nNode-Selectors:  <none>\nTolerations:     node"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("kubernetes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io/not-ready:NoExecute "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" 300s\n                 node"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("kubernetes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io/unreachable:NoExecute "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" 300s\nEvents:\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("Type")]),s._v("    Reason     Age        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("From")]),s._v("               Message\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("    "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("     "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("       "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("               "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("\n  Normal  Scheduled  <unknown>  default-scheduler  Successfully assigned dev/nginx-5ff7956ff6-fg2db to node1\n  Normal  Pulling    4m11s      kubelet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" node1     Pulling image "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx:1.17.1"')]),s._v("\n  Normal  Pulled     3m36s      kubelet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" node1     Successfully pulled image "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx:1.17.1"')]),s._v("\n  Normal  Created    3m36s      kubelet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" node1     Created container nginx\n  Normal  Started    3m36s      kubelet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" node1     Started container nginx\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br")])]),n("p",[n("strong",[s._v("访问Pod")])]),s._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取podIP")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get pods -n dev -o wide")]),s._v("\nNAME                     READY   STATUS    RESTARTS   AGE    IP             NODE    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" \nnginx-5ff7956ff6-fg2db   1/1     Running   0          190s   10"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("244"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("23   node1   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#访问POD")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# curl http://10.244.1.23:80")]),s._v("\n<"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("DOCTYPE html>\n<html>\n<head>\n\t<title>Welcome to nginx!<"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("title>\n<"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("head>\n<body>\n\t<p><em>Thank you "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("using")]),s._v(" nginx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("<"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("em><"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("p>\n<"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("body>\n<"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("html>\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("p",[n("strong",[s._v("删除指定Pod")])]),s._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除指定Pod")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl delete pod nginx-5ff7956ff6-fg2db -n dev")]),s._v("\npod "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx-5ff7956ff6-fg2db"')]),s._v(" deleted\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 此时，显示删除Pod成功，但是再查询，发现又新产生了一个 ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get pods -n dev")]),s._v("\nNAME                     READY   STATUS    RESTARTS   AGE\nnginx-5ff7956ff6-jj4ng   1/1     Running   0          21s\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这是因为当前Pod是由Pod控制器创建的，控制器会监控Pod状况，一旦发现Pod死亡，会立即重建")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 此时要想删除Pod，必须删除Pod控制器")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 先来查询一下当前namespace下的Pod控制器")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get deploy -n  dev")]),s._v("\nNAME    READY   UP-TO-DATE   AVAILABLE   AGE\nnginx   1/1     1            1           9m7s\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 接下来，删除此PodPod控制器")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl delete deploy nginx -n dev")]),s._v("\ndeployment"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apps "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx"')]),s._v(" deleted\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 稍等片刻，再查询Pod，发现Pod被删除了")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get pods -n dev")]),s._v("\nNo resources found in dev namespace"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br")])]),n("p",[n("strong",[s._v("配置操作")])]),s._v(" "),n("p",[s._v("创建一个pod-nginx.yaml，内容如下：")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Pod\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" dev\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("1.17.1\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pod\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("port\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containerPort")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("protocol")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" TCP\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("p",[s._v("然后就可以执行对应的创建和删除命令了：")]),s._v(" "),n("p",[s._v("​    创建：kubectl  create  -f  pod-nginx.yaml")]),s._v(" "),n("p",[s._v("​    删除：kubectl  delete  -f  pod-nginx.yaml")]),s._v(" "),n("h2",{attrs:{id:"label"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#label"}},[s._v("#")]),s._v(" Label")]),s._v(" "),n("p",[s._v("Label是kubernetes系统中的一个重要概念。它的作用就是在资源上添加标识，用来对它们进行区分和选择。")]),s._v(" "),n("p",[s._v("Label的特点：")]),s._v(" "),n("ul",[n("li",[s._v("一个Label会以key/value键值对的形式附加到各种对象上，如Node、Pod、Service等等")]),s._v(" "),n("li",[s._v("一个资源对象可以定义任意数量的Label ，同一个Label也可以被添加到任意数量的资源对象上去")]),s._v(" "),n("li",[s._v("Label通常在资源对象定义时确定，当然也可以在对象创建后动态添加或者删除")])]),s._v(" "),n("p",[s._v("可以通过Label实现资源的多维度分组，以便灵活、方便地进行资源分配、调度、配置、部署等管理工作。")]),s._v(" "),n("blockquote",[n("p",[s._v("一些常用的Label 示例如下：")]),s._v(" "),n("ul",[n("li",[s._v('版本标签："version":"release", "version":"stable"......')]),s._v(" "),n("li",[s._v('环境标签："environment":"dev"，"environment":"test"，"environment":"pro"')]),s._v(" "),n("li",[s._v('架构标签："tier":"frontend"，"tier":"backend"')])])]),s._v(" "),n("p",[s._v("标签定义完毕之后，还要考虑到标签的选择，这就要使用到Label Selector，即：")]),s._v(" "),n("p",[s._v("​    Label用于给某个资源对象定义标识")]),s._v(" "),n("p",[s._v("​    Label Selector用于查询和筛选拥有某些标签的资源对象")]),s._v(" "),n("p",[s._v("当前有两种Label Selector：")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("基于等式的Label Selector")]),s._v(" "),n("p",[s._v('name = slave: 选择所有包含Label中key="name"且value="slave"的对象')]),s._v(" "),n("p",[s._v('env != production: 选择所有包括Label中的key="env"且value不等于"production"的对象')])]),s._v(" "),n("li",[n("p",[s._v("基于集合的Label Selector")]),s._v(" "),n("p",[s._v('name in (master, slave): 选择所有包含Label中的key="name"且value="master"或"slave"的对象')]),s._v(" "),n("p",[s._v('name not in (frontend): 选择所有包含Label中的key="name"且value不等于"frontend"的对象')])])]),s._v(" "),n("p",[s._v('标签的选择条件可以使用多个，此时将多个Label Selector进行组合，使用逗号","进行分隔即可。例如：')]),s._v(" "),n("p",[s._v("​\t\tname=slave，env!=production")]),s._v(" "),n("p",[s._v("​\t\tname not in (frontend)，env!=production")]),s._v(" "),n("p",[n("strong",[s._v("命令方式")])]),s._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 为pod资源打标签")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl label pod nginx-pod version=1.0 -n dev")]),s._v("\npod/nginx-pod labeled\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 为pod资源更新标签")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl label pod nginx-pod version=2.0 -n dev --overwrite")]),s._v("\npod/nginx-pod labeled\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看标签")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get pod nginx-pod  -n dev --show-labels")]),s._v("\nNAME        READY   STATUS    RESTARTS   AGE   LABELS\nnginx-pod   1/1     Running   0          10m   version=2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("0\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 筛选标签")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get pod -n dev -l version=2.0  --show-labels")]),s._v("\nNAME        READY   STATUS    RESTARTS   AGE   LABELS\nnginx-pod   1/1     Running   0          17m   version=2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("0\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get pod -n dev -l version!=2.0 --show-labels")]),s._v("\nNo resources found in dev namespace"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除标签")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl label pod nginx-pod version- -n dev")]),s._v("\npod/nginx-pod labeled\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br")])]),n("p",[n("strong",[s._v("配置方式")])]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Pod\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" dev\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labels")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3.0"')]),s._v(" \n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("env")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("1.17.1\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pod\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("port\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containerPort")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("protocol")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" TCP\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("p",[s._v("然后就可以执行对应的更新命令了：kubectl  apply  -f  pod-nginx.yaml")]),s._v(" "),n("h2",{attrs:{id:"deployment"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#deployment"}},[s._v("#")]),s._v(" Deployment")]),s._v(" "),n("p",[s._v("​    在kubernetes中，Pod是最小的控制单元，但是kubernetes很少直接控制Pod，一般都是通过Pod控制器来完成的。Pod控制器用于pod的管理，确保pod资源符合预期的状态，当pod的资源出现故障时，会尝试进行重启或重建pod。")]),s._v(" "),n("p",[s._v("​     在kubernetes中Pod控制器的种类有很多，本章节只介绍一种：Deployment。")]),s._v(" "),n("img",{staticStyle:{border:"1px solid",zoom:"80%"},attrs:{src:t(627),alt:"image-20200408193950807"}}),s._v(" "),n("p",[n("strong",[s._v("命令操作")])]),s._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令格式: kubectl run deployment名称  [参数] ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --image  指定pod的镜像")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --port   指定端口")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --replicas  指定创建pod数量")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --namespace  指定namespace")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl run nginx --image=nginx:1.17.1 --port=80 --replicas=3 -n dev")]),s._v("\ndeployment"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apps/nginx created\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看创建的Pod")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get pods -n dev")]),s._v("\nNAME                     READY   STATUS    RESTARTS   AGE\nnginx-5ff7956ff6-6k8cb   1/1     Running   0          19s\nnginx-5ff7956ff6-jxfjt   1/1     Running   0          19s\nnginx-5ff7956ff6-v6jqw   1/1     Running   0          19s\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看deployment的信息")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get deploy -n dev")]),s._v("\nNAME    READY   UP-TO-DATE   AVAILABLE   AGE\nnginx   3/3     3            3           2m42s\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# UP-TO-DATE：成功升级的副本数量")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# AVAILABLE：可用副本的数量")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get deploy -n dev -o wide")]),s._v("\nNAME    READY UP-TO-DATE  AVAILABLE   AGE     CONTAINERS   IMAGES              SELECTOR\nnginx   3/3     3         3           2m51s   nginx        nginx:1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("17"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("1        run=nginx\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看deployment的详细信息")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl describe deploy nginx -n dev")]),s._v("\nName:                   nginx\nNamespace:              dev\nCreationTimestamp:      Wed"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 08 Apr 2020 11:14:14 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("0800\nLabels:                 run=nginx\nAnnotations:            deployment"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("kubernetes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io/revision: 1\nSelector:               run=nginx\nReplicas:               3 desired "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" 3 updated "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" 3 total "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" 3 available "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" 0 unavailable\nStrategyType:           RollingUpdate\nMinReadySeconds:        0\nRollingUpdateStrategy:  25% max unavailable"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 25% max surge\nPod Template:\n  Labels:  run=nginx\n  Containers:\n   nginx:\n    Image:        nginx:1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("17"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("1\n    Port:         80/TCP\n    Host Port:    0/TCP\n    Environment:  <none>\n    Mounts:       <none>\n  Volumes:        <none>\nConditions:\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("Type")]),s._v("           Status  Reason\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("           "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("\n  Available      True    MinimumReplicasAvailable\n  Progressing    True    NewReplicaSetAvailable\nOldReplicaSets:  <none>\nNewReplicaSet:   nginx-5ff7956ff6 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("3/3 replicas created"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nEvents:\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("Type")]),s._v("    Reason             Age    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("From")]),s._v("                   Message\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("    "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("             "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("                   "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("\n  Normal  ScalingReplicaSet  5m43s  deployment-controller  Scaled up replicaset nginx-5ff7956ff6 to 3\n  \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除 ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl delete deploy nginx -n dev")]),s._v("\ndeployment"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apps "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx"')]),s._v(" deleted\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br")])]),n("p",[n("strong",[s._v("配置操作")])]),s._v(" "),n("p",[s._v("创建一个deploy-nginx.yaml，内容如下：")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" apps/v1\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Deployment\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" dev\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("replicas")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("selector")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("matchLabels")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("run")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("template")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labels")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("run")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("1.17.1\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containerPort")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("protocol")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" TCP\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br")])]),n("p",[s._v("然后就可以执行对应的创建和删除命令了：")]),s._v(" "),n("p",[s._v("​    创建：kubectl  create  -f  deploy-nginx.yaml")]),s._v(" "),n("p",[s._v("​    删除：kubectl  delete  -f  deploy-nginx.yaml")]),s._v(" "),n("h2",{attrs:{id:"service"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#service"}},[s._v("#")]),s._v(" Service")]),s._v(" "),n("p",[s._v("通过上节课的学习，已经能够利用Deployment来创建一组Pod来提供具有高可用性的服务。")]),s._v(" "),n("p",[s._v("虽然每个Pod都会分配一个单独的Pod IP，然而却存在如下两问题：")]),s._v(" "),n("ul",[n("li",[s._v("Pod IP 会随着Pod的重建产生变化")]),s._v(" "),n("li",[s._v("Pod IP 仅仅是集群内可见的虚拟IP，外部无法访问")])]),s._v(" "),n("p",[s._v("这样对于访问这个服务带来了难度。因此，kubernetes设计了Service来解决这个问题。")]),s._v(" "),n("p",[s._v("Service可以看作是一组同类Pod"),n("strong",[s._v("对外的访问接口")]),s._v("。借助Service，应用可以方便地实现服务发现和负载均衡。")]),s._v(" "),n("p",[n("img",{attrs:{src:t(509),alt:"image-20200408194716912"}})]),s._v(" "),n("p",[n("strong",[s._v("操作一：创建集群内部可访问的Service")])]),s._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 暴露Service")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl expose deploy nginx --name=svc-nginx1 --type=ClusterIP --port=80 --target-port=80 -n dev")]),s._v("\nservice/svc-nginx1 exposed\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看service")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get svc svc-nginx -n dev -o wide")]),s._v("\nNAME         "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("TYPE")]),s._v("        CLUSTER-IP       EXTERNAL-IP   PORT"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("S"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   AGE     SELECTOR\nsvc-nginx1   ClusterIP   10"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("109"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("179"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("231   <none>        80/TCP    3m51s   run=nginx\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里产生了一个CLUSTER-IP，这就是service的IP，在Service的生命周期中，这个地址是不会变动的")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以通过这个IP访问当前service对应的POD")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# curl 10.109.179.231:80")]),s._v("\n<"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("DOCTYPE html>\n<html>\n<head>\n<title>Welcome to nginx!<"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("title>\n<"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("head>\n<body>\n<h1>Welcome to nginx!<"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("h1>\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n<"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("body>\n<"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("html>\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br")])]),n("p",[n("strong",[s._v("操作二：创建集群外部也可访问的Service")])]),s._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 上面创建的Service的type类型为ClusterIP，这个ip地址只用集群内部可访问")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果需要创建外部也可以访问的Service，需要修改type为NodePort")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl expose deploy nginx --name=svc-nginx2 --type=NodePort --port=80 --target-port=80 -n dev")]),s._v("\nservice/svc-nginx2 exposed\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 此时查看，会发现出现了NodePort类型的Service，而且有一对Port（80:31928/TC）")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get svc  svc-nginx-1  -n dev -o wide")]),s._v("\nNAME          "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("TYPE")]),s._v("        CLUSTER-IP       EXTERNAL-IP   PORT"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("S"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("        AGE    SELECTOR\nsvc-nginx2    NodePort    10"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("100"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("94"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("0      <none>        80:31928/TCP   9s     run=nginx\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 接下来就可以通过集群外的主机访问 节点IP:31928访问服务了")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 例如在的电脑主机上通过浏览器访问下面的地址")]),s._v("\nhttp:"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("192"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("168"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("109"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("100:31928/\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("p",[n("strong",[s._v("删除Service")])]),s._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master ~]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl delete svc svc-nginx-1 -n dev                                   ")]),s._v("\nservice "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"svc-nginx-1"')]),s._v(" deleted\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[n("strong",[s._v("配置方式")])]),s._v(" "),n("p",[s._v("创建一个svc-nginx.yaml，内容如下：")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Service\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" svc"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("nginx\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" dev\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("clusterIP")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 10.109.179.231\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("protocol")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" TCP\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("targetPort")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("selector")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("run")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ClusterIP\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("p",[s._v("然后就可以执行对应的创建和删除命令了：")]),s._v(" "),n("p",[s._v("​    创建：kubectl  create  -f  svc-nginx.yaml")]),s._v(" "),n("p",[s._v("​    删除：kubectl  delete  -f  svc-nginx.yaml")]),s._v(" "),n("blockquote",[n("p",[n("strong",[s._v("小结")])]),s._v(" "),n("p",[s._v("​    至此，已经掌握了Namespace、Pod、Deployment、Service资源的基本操作，有了这些操作，就可以在kubernetes集群中实现一个服务的简单部署和访问了，但是如果想要更好的使用kubernetes，就需要深入学习这几种资源的细节和原理。")])])])}),[],!1,null,null,null);a.default=e.exports}}]);